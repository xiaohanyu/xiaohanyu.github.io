<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" />
    <meta content="width=1300, initial-scale=1 user-scalable=yes" name="viewport" />
    <meta content="行者无疆，始于足下——行走，思考，在路上" name="description" />
    <meta content="web development, programming, typeface, typography" name="keywords" />
    <meta content="Xiao Hanyu" name="author" />
    <link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180" />
    <link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png" />
    <link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png" />
    <link href="/manifest.json" rel="manifest" />
    <link color="#5bbad5" href="/safari-pinned-tab.svg" rel="mask-icon" />
    <meta content="#ffffff" name="theme-color" />
    <title>一个Shell Script的诞生</title>
    <link href="/static/dist/semantic-ui/semantic.min.css" rel="stylesheet" type="text/css" />
    <link href="/static/dist/fonts.css/fonts.css" rel="stylesheet" type="text/css" />
    <link href="/static/stylesheet/default.css" rel="stylesheet" type="text/css" />
    <link href="/static/stylesheet/pandoc-code-highlight.css" rel="stylesheet" type="text/css" />
    <script src="/static/dist/jquery/jquery.min.js"></script>
  </head>
  <body lang="cn">
    <div data-quotes-cn="[{&quot;content&quot;:[&quot;天上星，亮晶晶，永灿烂，长安宁。&quot;,&quot;湖边竹，盈盈绿，报平安，多喜乐。&quot;],&quot;author&quot;:&quot;金庸&quot;,&quot;from&quot;:&quot;天龙八部&quot;},{&quot;content&quot;:[&quot;死亡是唯一一座永远亮着的灯塔，不管你向哪里航行，最终都得转向它指引的方向。一切都会逝去，只有死神永生。&quot;],&quot;author&quot;:&quot;刘慈欣&quot;,&quot;from&quot;:&quot;地球往事&quot;},{&quot;content&quot;:[&quot;我终于明白了为什么 Einstein 喜爱看守灯塔的职业，因为那样他可以在自己的心灵中建立一片宁静而自由的天空。&quot;],&quot;author&quot;:&quot;卢昌海&quot;,&quot;from&quot;:&quot;&lt;a href=\&quot;http://www.changhai.org\&quot;&gt;http://www.changhai.org&lt;/a&gt;&quot;},{&quot;content&quot;:[&quot;我宁愿游荡在你身边&quot;,&quot;做七天的野鬼&quot;,&quot;跟随你&quot;,&quot;就算落进最黑暗的地方&quot;,&quot;我的爱&quot;,&quot;也不会让我成为永远的孤魂&quot;],&quot;author&quot;:&quot;李安&quot;,&quot;from&quot;:&quot;卧虎藏龙&quot;},{&quot;content&quot;:[&quot;在中国，任何超脱飞扬的思想都会砰然坠地——现实的引力实在是太沉重了。&quot;],&quot;author&quot;:&quot;刘慈欣&quot;,&quot;from&quot;:&quot;地球往事&quot;},{&quot;content&quot;:[&quot;天下唯庸人无咎无誉。&quot;],&quot;author&quot;:&quot;梁启超&quot;,&quot;from&quot;:&quot;李鸿章传&quot;},{&quot;content&quot;:[&quot;沧海横流，血肉横飞，方显出英雄本色，当年万源保卫战，敌军在不到 30 华里的地面上，使用兵力竞达九十个团，数量十倍于红军，谁能记清当时打了多少次恶仗？每天要牺牲多少人？他却是不多的幸存者之一。而眼前，一切都沉寂了，流逝了。那惊心动魄的枪声，那撕肝裂肺的呐喊，那悲痛欲绝的咒骂和呻吟，那狼藉遍野的残肢断骨和头颅，那千疮百孔仍迎风飘扬的军旗；都沉寂了，流逝了，无影无踪了，犹如做了一场梦……&quot;],&quot;author&quot;:&quot;都梁&quot;,&quot;from&quot;:&quot;亮剑&quot;}]" data-quotes-en="[{&quot;content&quot;:[&quot;Pascal is for building pyramids—imposing, breathtaking, static structures built by armies pushing heavy blocks into place. Lisp is for building organisms—imposing, breathtaking, dynamic structures built by squads fitting fluctuating myriads of simpler organisms into place.&quot;],&quot;author&quot;:&quot;Alan J. Perlis&quot;,&quot;from&quot;:&quot;foreword for &lt;a href=\&quot;http://mitpress.mit.edu/sicp/\&quot;&gt;SICP&lt;/a&gt;&quot;},{&quot;content&quot;:[&quot;When you don&#39;t create things, you become defined by your tastes rather than ability. Your tastes only narrow &amp; exclude people. So create.&quot;],&quot;author&quot;:&quot;why the luck stiff&quot;,&quot;from&quot;:&quot;&lt;a href=\&quot;http://whymirror.github.io/\&quot;&gt;http://whymirror.github.io/&lt;/a&gt;&quot;},{&quot;content&quot;:[&quot;In theory, there is no difference between theory and practice. But, in practice, there is.&quot;],&quot;author&quot;:&quot;Jan L. A. van de Snepscheut&quot;,&quot;from&quot;:&quot;&lt;a href=\&quot;http://en.wikiquote.org/wiki/Jan_L._A._van_de_Snepscheut\&quot;&gt;Wikipedia&lt;/a&gt;&quot;},{&quot;content&quot;:[&quot;The future has already arrived. It is just not evenly distributed yet.&quot;],&quot;author&quot;:&quot;William Gibson&quot;,&quot;from&quot;:&quot;&lt;a href=\&quot;https://en.wikiquote.org/wiki/William_Gibson\&quot;&gt;Wikiquote&lt;/a&gt;&quot;},{&quot;content&quot;:[&quot;There are many ways of trying to understand programs. People often rely too much on one way, which is called \&quot;debugging\&quot; and consists of running a partly-understood program to see if it does what you expected. Another way, which ML advocates, is to install some means of understanding in the very programs themselves.&quot;],&quot;author&quot;:&quot;Robin Milner&quot;,&quot;from&quot;:&quot;foreword for &lt;a href=\&quot;http://www.ccs.neu.edu/home/matthias/BTML/\&quot;&gt;The Little MLer&lt;/a&gt;&quot;}]" id="quotes" style="display: none"></div>
    <div id="content">
      <nav class="ui borderless menu" lang="en">
        <div class="ui container">
          <a class="item" href="/"><img src="/static/image/gravatar-black.svg" /></a><a class="item" href="/archive">Archive</a><a class="item desktop-only" href="/categories">Categories</a><a class="item desktop-only" href="/tags">Tags</a><a class="item" href="/about">About</a>
          <div class="right menu">
            <div class="item desktop-only">
              <form action="https://www.google.com/search" class="ui form" method="get" target="_blank">
                <input name="q" type="hidden" value="site:xiaohanyu.me" />
                <div class="ui transparent left icon input">
                  <input name="q" placeholder="Search..." type="text" /><i class="search icon"></i>
                </div>
              </form>
            </div>
            <a class="item" href="https://github.com/xiaohanyu"><i class="github icon"></i></a><a class="item desktop-only" href="/atom.xml"><i class="feed icon"></i></a>
          </div>
        </div>
      </nav><div class="ui stackable container">
  <div class="ui very padded segment article">
    <article class="ui stackable divided grid"><header class="row article-head">
  <div class="column">
    <h1 class="ui header">
      一个Shell Script的诞生
    </h1>
    <div class="ui divider"></div>
  </div>
</header>
<div class="row article-body">
  <section class="twelve wide column"><p>任务：一批视频文件，需要</p>
<ol>
<li>自动化地转码成指定的格式</li>
<li>上传到服务器</li>
<li>得到文件的url地址</li>
</ol>
<p>对于转码工作，目前为止依然没有顺利的完成，由于网上资料贫乏，各种视频音频格式、编解码器、专利开源问题比较纠结，需要很长的时间理清这些关系。我重点研究了<a href="http://www.ffmpeg.org/">ffmpeg</a>和<a href="http://yamdi.sourceforge.net/">yamdi</a>这两个工具。但是今天用yamdi的时候发现一个很奇怪的bug——它会自动改变原始视频文件的fps和bitrate作为输出文件，非常奇怪，可能会比较棘手。</p>
<p>对于第二个问题，经过几天的探索，顺带复习许久之前的Bash Scripting知识和众多的Unix Power Tools，终于想出了比较完善可行的方案，诞生了人生第一个比较“成形”的Shell脚本，惭愧……</p>
<p>首先给出我的脚本和模板配置文件，然后再逐步分析——</p>
<p>send_file.sh：</p>
<pre class="example"><code>#!/bin/bash 

################################################################################
# Purpose:  This interactive script is used for upload files onto a ftp server automatically.   
# Author:   Xiao Hanyu(xiaohanyu@taohua.com)
# Usage:    ./send_file.sh
# Depends: 
#       lftp:       used to transfer files
#       tree:       used to get the directory tree
#       sed:        used to get the filename
#       sort:       used to match the url and the filename into a csv file
# Notes:
#       This script need a configuration files which is set by -f parameter. 
#       I have given a sample configuration file: sample.conf
#       After running this script, it will output the [filename:url] list to a file
################################################################################

# This function checks whether the necessary tools are available
function usage
{
    cat &lt;&lt; EOF
`basename $0`: A utility to send files to a remote ftp server automatically

Usage: `basename $0` [Action]
Example: `basename $0` -f config_file

Actions:
    -f:         set the configuration files
    -h:         show this help
EOF
}

# check the necessary tools
function check_version
{
    $1 --version &gt; /dev/null

    if [ $? -ne 0 ]
    then
        echo &quot;You must install $1 before executing this script.&quot;
        echo &quot;You can type \&quot;sudo apt-get install $1\&quot; to finish this task under ubuntu os.&quot;
        echo &quot;exit ...&quot;
        exit 1
    fi
}

# make sure that you have permission to create a temporary file under current directory
function check_perm
{
    touch tmp_lftp_script_file
    if [ $? -ne &quot;0&quot; ]
    then    
        echo &quot;You don&#39;t have permission to create temporary file under current directory.&quot;
        echo &quot;Type \&quot;chmod u+w current_directory\&quot; to give users write permissions.&quot;
        echo &quot;exit ...&quot;
        exit 1
    else
        rm -f tmp_lftp_script_file
    fi
}

# this script use some file to store something, so 
# if the file exists, we backup it into file.bak, and 
# create a new empty file
function check_bak_file
{
    if [ -e $1 ]
    then
        cp $1 $1.bak
    fi

    cat /dev/null &gt; $1
}

# parse parameters
#   -f for configuration file
#   -h for command help
while getopts &quot;f:h&quot; arg
do  
    case $arg in
        f)
            config_file=$OPTARG
            ;;
        h)
            usage
            exit 0
            ;;
        ?)
            echo &quot;!!Wrong command options!&quot;
            usage
            exit 1
            ;;
    esac
done

# check whether or not configuration file exists
if [ -e $config_file ]
then    
    # if $config_file exist, import the necessary variable
    source $config_file
else
    echo &quot;configuration file not exist.&quot; 
    echo &quot;exit ...&quot;
    exit 1
fi

# check lftp version
echo 
check_version lftp

# check tree version
echo 
check_version tree

# check permission
check_perm

# This file containts the command executed by lftp after login ftp server&quot;
lftp_script=lftp_sh
check_bak_file $lftp_script 

# $url_file store the [key:value] for filenames and urls
check_bak_file $url_file

# ftp anonymous login
username=${username:-&quot;anonymous&quot;}
password=${password:-&quot;anonymous&quot;}

# ftp default port
port=${port:-&quot;21&quot;}

# create lftp script executed by lftp 
echo &quot;lftp $username:$password@$host:$port&quot; &gt;&gt; $lftp_script
echo &quot;ls&quot; &gt;&gt; $lftp_script
echo &quot;cd $rdir&quot; &gt;&gt; $lftp_script

for file in $lfiles
do
    if [ -d $file ]                 # if $file is a directory, we should use &#39;lftp mirror -R&#39; command
    then
        echo &quot;mirror -R $file&quot; &gt;&gt; $lftp_script

        # use $(tree -ifp --noreport $file | grep &quot;\[&quot; | grep -v &quot;\[d&quot; | tr -s &#39; &#39; | cut -d&#39; &#39; -f2 | sed -e &#39;s/\.\{1,2\}\///g&#39;) 
        # to get all the filenames(contains relative path such &quot;../../&quot;, &quot;./&quot;, &quot;../&quot;, &quot;/&quot;, so we should use sed to get rid of these
        for tmp_file in $(tree -ifp --noreport $file | grep &quot;\[&quot; | grep -v &quot;\[d&quot; | tr -s &#39; &#39; | cut -d&#39; &#39; -f2 | sed -e &#39;s/\.\{1,2\}\///g&#39;)
        do
            if [[ $rdir == &quot;.&quot; || $rdir == &quot;&quot; ]]    # if $rdir==&quot;.&quot;, we shouldn&#39;t give a url like &#39;http://hostname/./filename&#39;
            then
                echo -e &quot;$(basename $tmp_file | sed -e &#39;s/\..*//g&#39;)\thttp://$host/$tmp_file&quot; &gt;&gt; $url_file
            else
                echo -e &quot;$(basename $tmp_file | sed -s &#39;s/\..*//g&#39;)\thttp://$host/$rdir/$tmp_file&quot; &gt;&gt; $url_file
            fi
        done
    elif [ -e $file ]
    then 
        echo &quot;put $file&quot; &gt;&gt; $lftp_script
        if [[ $rdir == &quot;.&quot; || $rdir == &quot;&quot; ]]
        then
            echo -e &quot;$file\thttp://$host/$file&quot; &gt;&gt; $url_file
        else
            echo -e &quot;$file\thttp://$host/$rdir/$file&quot; &gt;&gt; $url_file
        fi
        else
                echo &quot;!!Warning: $file not exist!&quot;
        fi
done

lftp -f $lftp_script

if [ $? -ne 0 ]
then
    echo &quot;Sending file failed, please check your ftp information.&quot;
    echo &quot;exit ...&quot;
else
    echo &quot;Sending file successfully!&quot;
fi

# echo &quot;rm -f $lftp_script&quot;
</code></pre>
<p>sample.conf：</p>
<pre class="example"><code>########################################
# Purpose: This file is the sample configuration file for the send_file utility
# Author: Xiao Hanyu(xiaohanyu@taohua.com)
# Warning:
#   This file use bash script grammer to config, which means, you can&#39;t leave any space around &#39;=&#39;
#   Examples:
#       a=b     &lt;&lt;--&gt;&gt;      right grammer
#       b =c    &lt;&lt;--&gt;&gt;      wrong grammer
#       c= d    &lt;&lt;--&gt;&gt;      wrong grammer
#       d = f   &lt;&lt;--&gt;&gt;      wrong grammer
#   Second, all the variables marked &#39;!!&#39; is necessary, others have default values
#   Examples:
#       config_file=        #!!(necessary variable)
#       username=           (not necessary variable)
#   Third, all the parameter should be quoted by &quot;&quot;
########################################

# username and password to login an ftp server
username=&quot;tiger&quot;
password=&quot;tiger&quot;

# hostname or ip of the remote ftp server
host=&quot;10.36.100.9&quot;          #!! necessary variable

# port, default is 21
port=

# local files, you should give the right absolute path
# or the right relative path
# both files are directories are allowed
# files and directories are seperated by [space] or [tab]
lfiles=&quot;send_file.sh sh_test sample.conf ../tmp t f g h ./sh_test&quot;

# remote directory which you upload your files into
rdir=&quot;videos&quot;

# specify the url_file
# url_file consists of two columns: filename and urls
url_file=&quot;url_list&quot;
</code></pre>
<p>代码的注释比较详尽了，函数名称基本也能如实反映函数的作用，我来说明下基本思路。</p>
<p>首先是命令行选项的解析，这个根据复杂度不同有三种方法：</p>
<ol>
<li>直接用$1, $2, $3手工处理，暴力解析。这里你需要知道几个Bash变量，如$0代表bash脚本的名字，$1~$9分别代表着第1~9个命令行参数等等。优点是比较简单，缺点是太“简单”了。</li>
<li>getopts，Bash内置，只支持短选项如’-a -b -c’，’-a option1 -b -c’，’-abc‘，不支持长选项如’–version’这样的，使用比较简单（因为是Bash内置嘛）。</li>
<li>getopt，外部命令，比较复杂，支持长选项，我还不会用。</li>
</ol>
<p>C++ <a href="http://www.boost.org/">Boost</a>库提供<a href="http://www.boost.org/doc/libs/1_43_0/doc/html/program_options.html">Options</a>组件，用来解析命令行参数。具体的实例可以参见<a href="http://www.cnblogs.com/FrankTan/archive/2010/03/01/1634516.html">Bash Shell中命令行选项/参数处理</a>。我的脚本中用的是第二种方法。</p>
<p>第二个大问题是参数选项的问题。我们可以通过两种方式配置参数，从而让我们的脚本自动化地做出适应性的处理。第一种方法是通过命令行参数，就是上面谈的getopt/getopts，这种方法的好处就是方便直观快捷，变量解析可以用Bash内置的read或者高级一点的<a href="http://www.nist.gov/mel/msid/expect.cfm">TCL/Expect</a>（这个我也不会<img src="http://cnlox.is-programmer.com/javascripts/fckeditor/editor/images/smiley/chito/embaressed_smile.gif" />），缺点在于每次敲命令的时候都要敲这一堆命令行参数，而且对于运维人员来说是一种非常不user-friendly的方式；第二种方法就是通过配置文件，让我们的Bash脚本自己解析指定的配置文件来获取相应的信息——比如ftp登录的username和password、需要上传的文件、上传的远端目录等等。</p>
<p>配置文件的格式有多种选择，pluskid大神的<a href="http://blog.pluskid.org/?p=310">闲谈程序的配置文件</a>是篇很不错的说明。我的脚本功能比较简单，配置文件自然也不会太复杂，因此我想出了一个非常“卑鄙无耻”的方法——就是直接将配置文件写成bash script变量赋值的形式，然后在脚本中通过这么一句：</p>
<pre class="example"><code>source $config_file
</code></pre>
<p>直接引入配置变量。我承认我太卑鄙了，当然好处是简单可行——但是对于运维人员（使用这个脚本的人来说），可能会莫名奇妙——为啥等号后面不能有空格，为啥变量赋值最好要加引号——因为他们不懂Bash Script的语法——所以每次写脚本的时候、想象一下假设你就是那个要使用脚本的人，怎样才算友好的脚本？——但是我没有时间研究更复杂的脚本解析了——欢迎指正。</p>
<p>第三个大问题是ftp自动登录上传文件的问题。如果我们把平时的ftp登录操作比作用vim编辑文件，那么自动化的ftp登录就是用sed来处理文件。想象一下，我们平时登录ftp，windows下，我们会点开一个ftp软件，点击快速链接，输入username和password，然后下载上传。linux有万能的lftp命令行工具，因此实现自动化的功能，从lftp的参数选项着手是比较有希望的选择。</p>
<p>功夫不负有心人，lftp有两种手段能够实现自动化的登录上传下载。第一种方式是通过lftp -f lftp_script_file的方式，-f指定一个文件lftp_script_file，这个文件里面包含登录lftp的命令和上传下载文件的命令。第二种方式是通过lftp的-u参数指定登 录名密码和-e选项指定登录后执行的lftp命令。这种方式的缺点在于每执行一条命令都要登录一下ftp——不过登录ftp所耗费的时间与上传文件的时间相比几乎可以忽略不计，所以也算不上一个大的缺点。</p>
<p>除了以上两种方式，我在扫<a href="http://tldp.org/LDP/abs/html/">ABS</a>的时候偶然发现了<a href="http://tldp.org/LDP/abs/html/here-docs.html">Here Documents</a>这个东西——这个曾经听说过但从来没有认真看过的东西，才发现这东西也有很多妙处，使用的当，同样可以实现lftp的自动登录上传。我采用的是lftp的-f选项，touch一个临时文件完成自动登录上传的。</p>
<p>第四个问题是url提取的问题。具体来说，比如你远端ftp和http服务器的地址是hostname，远端目录是videos，本地上传文件是send_file.sh、hpm.avi，你需要生成如下的[filename:url]的list：</p>
<pre class="example"><code>send_file    http://hostname/videos/send_file.sh
hpm    http://hostname/videos/hpm.avi
</code></pre>
<p>然后存储这个list到一个文件里面，供后面进一步的URL生成映射处理之用。这个问题是耗时最久的一个问题。我的脚本里面有这么一段：</p>
<pre class="example"><code>for file in $lfiles
do
    if [ -d $file ]                 # if $file is a directory, we should use &#39;lftp mirror -R&#39; command
    then
        echo &quot;mirror -R $file&quot; &gt;&gt; $lftp_script

        # use $(tree -ifp --noreport $file | grep &quot;\[&quot; | grep -v &quot;\[d&quot; | tr -s &#39; &#39; | cut -d&#39; &#39; -f2 | sed -e &#39;s/\.\{1,2\}\///g&#39;) 
        # to get all the filenames(contains relative path such &quot;../../&quot;, &quot;./&quot;, &quot;../&quot;, &quot;/&quot;, so we should use sed to get rid of these
        for tmp_file in $(tree -ifp --noreport $file | grep &quot;\[&quot; | grep -v &quot;\[d&quot; | tr -s &#39; &#39; | cut -d&#39; &#39; -f2 | sed -e &#39;s/\.\{1,2\}\///g&#39;)
        do
            if [[ $rdir == &quot;.&quot; || $rdir == &quot;&quot; ]]    # if $rdir==&quot;.&quot;, we shouldn&#39;t give a url like &#39;http://hostname/./filename&#39;
            then
                echo -e &quot;$(basename $tmp_file | sed -e &#39;s/\..*//g&#39;)\thttp://$host/$tmp_file&quot; &gt;&gt; $url_file
            else
                echo -e &quot;$(basename $tmp_file | sed -s &#39;s/\..*//g&#39;)\thttp://$host/$rdir/$tmp_file&quot; &gt;&gt; $url_file
            fi
        done
    elif [ -e $file ]
    then 
        echo &quot;put $file&quot; &gt;&gt; $lftp_script
        if [[ $rdir == &quot;.&quot; || $rdir == &quot;&quot; ]]
        then
            echo -e &quot;$file\thttp://$host/$file&quot; &gt;&gt; $url_file
        else
            echo -e &quot;$file\thttp://$host/$rdir/$file&quot; &gt;&gt; $url_file
        fi
        else
                echo &quot;!!Warning: $file not exist!&quot;
        fi
done
</code></pre>
<p>其中针对目录的处理尤为复杂，比如你可以指定../../tmp这样的目录，如果你不作合适的处理，生成的URL可能是http://hostname/../../tmp/之类的东西。我最开始想的方法是递归目录的处理方法，但是写了好几个版本依然没有写出Bash的递归目录遍历。后来偶然间想到了tree，这个可以列出目录树的命令，仔细研究了它的参数选项，同时以管道的方式结合其他命令如grep（正向和反向匹配）、tr（压缩相同字符）、cut（提取某个column，可以用awk的print实现同样的功能）、sed（字符串处理，去除文件的路径和后缀），终于胜利地完成了这个任务。所谓成就感就是这么来的，哈。</p>
<p>至此，脚本需要解决的主要问题都已经阐述完毕，其余的问题都是一些小技俩，比如检查相关依赖工具是否安装、检查用户权限、提供帮助信息等等。目前发现一个bug，还是目录上传的时候有时会出现递归上传的问题，非常奇怪。</p>
<p>脚本的改进之处也有很多，比如：</p>
<ul>
<li>给出更加友好的提示帮助信息</li>
<li>给出更健壮的配置文件语法</li>
<li>自动检查每个文件是否上传成功，如果没有成功，能否实现断点续传</li>
<li>支持log文件输出，便于时候分析和故障分析</li>
<li>如果磁盘空间不够给出警告信息等等</li>
</ul>
<p>ok，到此为止，睡觉去。</p>

    <div class="ui divider"></div>
    <div class="ui small one item menu">
      <a class="item" id="show-disqus-comments" onclick="show_disqus_comments()" title="Fuck GFW, disqus.com has been blocked in China.">Show Disqus Comments</a>
    </div>
    <div id="disqus_thread"></div>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </section>
  <aside class="four wide column">
    <div class="ui small header">
      License
    </div>
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img class="cc-license" src="/static/image/cc_byncsa.flat.guokr.svg" /></a>
    <div class="ui small header">
      Committed
    </div>
    <date>2010-08-03</date>
    <div class="ui small header">
      Updated
    </div>
    <date>2017-04-14</date>
    <div class="ui small header">
      Category
    </div>
    <div class="ui list">
      <div class="item">
        <a href="/categories#shell">
          <div class="ui label">
            Shell<sup>2</sup>
          </div>
        </a>
      </div>
    </div>
    <div class="ui small header">
      Tags
    </div>
    <div class="ui list">
      <div class="item">
        <a href="/tags#sed">
          <div class="ui label">
            sed<sup>2</sup>
          </div>
        </a>
      </div>
      <div class="item">
        <a href="/tags#grep">
          <div class="ui label">
            Grep<sup>1</sup>
          </div>
        </a>
      </div>
      <div class="item">
        <a href="/tags#shell">
          <div class="ui label">
            Shell<sup>2</sup>
          </div>
        </a>
      </div>
      <div class="item">
        <a href="/tags#lftp">
          <div class="ui label">
            LFTP<sup>1</sup>
          </div>
        </a>
      </div>
    </div>
    <div class="ui small header">
      Meta
    </div>
    <p>
      Imported from <a href="http://cnlox.is-programmer.com/posts/19656.html">is-programmer</a>.
    </p>
    <div class="ui small header">
      Links
    </div>
    <div class="ui small two item menu">
      <a class="item" title="一个人的自在" href="/posts/2010-08-02-comfortable-life/">Prev</a><a class="item" title="w3cschool javascript 笔记(1)" href="/posts/2010-08-30-notes-on-w3cschool-javascript/">Next</a>
    </div>
  </aside>
</div>
    </article>
  </div>
</div>
    </div>
    <div id="footer">
      <footer class="ui inverted vertical center aligned footer segment">
        <div class="ui container">
          <p>
            Copyright © 2009–2017 by Xiao Hanyu — Powered by Emacs, Git, Pandoc, Ruby and Nanoc.
          </p>
        </div>
      </footer>
      <script src="/static/dist/semantic-ui/semantic.min.js"></script>
      <script src="/static/javascript/ga.js"></script>
      <script src="/static/javascript/default.js"></script>
    </div>
  </body>
</html>